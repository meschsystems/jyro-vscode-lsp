{
  "Variable Declaration": {
    "prefix": "var",
    "body": [
      "var ${1:name} = ${2:value}"
    ],
    "description": "Declare a variable"
  },
  "Variable Declaration with Type": {
    "prefix": "vart",
    "body": [
      "var ${1:name} : ${2|number,string,boolean,object,array|} = ${3:value}"
    ],
    "description": "Declare a variable with type annotation"
  },
  "If-Then-End": {
    "prefix": "if",
    "body": [
      "if ${1:condition} then",
      "\t$0",
      "end"
    ],
    "description": "If statement"
  },
  "If-Then-Else-End": {
    "prefix": "ife",
    "body": [
      "if ${1:condition} then",
      "\t${2:# true branch}",
      "else",
      "\t${3:# false branch}",
      "end"
    ],
    "description": "If-else statement"
  },
  "If-Else-If-End": {
    "prefix": "ifeif",
    "body": [
      "if ${1:condition1} then",
      "\t${2:# first branch}",
      "elseif ${3:condition2} then",
      "\t${4:# second branch}",
      "else",
      "\t${5:# default branch}",
      "end"
    ],
    "description": "If-else-if statement"
  },
  "Elseif Clause": {
    "prefix": "elseif",
    "body": [
      "elseif ${1:condition} then",
      "\t$0"
    ],
    "description": "Elseif clause for existing if statement"
  },
  "While Loop": {
    "prefix": "while",
    "body": [
      "while ${1:condition} do",
      "\t$0",
      "end"
    ],
    "description": "While loop"
  },
  "For Loop": {
    "prefix": "for",
    "body": [
      "for ${1:i} in ${2:0} to ${3:10} do",
      "\t$0",
      "end"
    ],
    "description": "For loop"
  },
  "For Loop with Step": {
    "prefix": "forby",
    "body": [
      "for ${1:i} in ${2:0} to ${3:10} by ${4:2} do",
      "\t$0",
      "end"
    ],
    "description": "For loop with step"
  },
  "For Loop Descending": {
    "prefix": "fordown",
    "body": [
      "for ${1:i} in ${2:10} downto ${3:0} do",
      "\t$0",
      "end"
    ],
    "description": "For loop descending"
  },
  "Foreach Loop": {
    "prefix": "foreach",
    "body": [
      "foreach ${1:item} in ${2:array} do",
      "\t$0",
      "end"
    ],
    "description": "Foreach loop"
  },
  "Foreach with Data": {
    "prefix": "foreachdata",
    "body": [
      "foreach ${1:item} in Data.${2:items} do",
      "\t$0",
      "end"
    ],
    "description": "Foreach loop over Data property"
  },
  "Switch Statement": {
    "prefix": "switch",
    "body": [
      "switch ${1:expression} do",
      "\tcase ${2:value1} then",
      "\t\t${3:# case 1}",
      "\tend",
      "\tcase ${4:value2} then",
      "\t\t${5:# case 2}",
      "\tend",
      "\tdefault then",
      "\t\t${6:# default}",
      "\tend",
      "end"
    ],
    "description": "Switch statement"
  },
  "Case Clause": {
    "prefix": "case",
    "body": [
      "case ${1:value} then",
      "\t$0",
      "end"
    ],
    "description": "Case clause with end"
  },
  "Case Clause Multi-value": {
    "prefix": "casem",
    "body": [
      "case ${1:value1}, ${2:value2} then",
      "\t$0",
      "end"
    ],
    "description": "Case clause with multiple values"
  },
  "Default Clause": {
    "prefix": "defaultcase",
    "body": [
      "default then",
      "\t$0",
      "end"
    ],
    "description": "Default clause with end"
  },
  "Ternary Operator": {
    "prefix": "tern",
    "body": [
      "${1:condition} ? ${2:trueValue} : ${3:falseValue}"
    ],
    "description": "Ternary conditional operator"
  },
  "Array Literal": {
    "prefix": "arr",
    "body": [
      "[${1:}]"
    ],
    "description": "Array literal"
  },
  "Object Literal": {
    "prefix": "obj",
    "body": [
      "{ ${1:\"key\"}: ${2:value} }"
    ],
    "description": "Object literal"
  },
  "WhereByField": {
    "prefix": "wherefield",
    "body": [
      "WhereByField(${1:array}, \"${2:field}\", \"${3|==,!=,<,>,<=,>=|}\", ${4:value})"
    ],
    "description": "Filter array by field condition"
  },
  "Sort Array": {
    "prefix": "sort",
    "body": [
      "SortByField(${1:array}, \"${2:field}\", \"${3|asc,desc|}\")"
    ],
    "description": "Sort array by field"
  },
  "Date Add": {
    "prefix": "dateadd",
    "body": [
      "DateAdd(${1:date}, ${2:amount}, \"${3|days,weeks,months,years,hours,minutes,seconds|}\")"
    ],
    "description": "Add time to a date"
  },
  "Date Diff": {
    "prefix": "datediff",
    "body": [
      "DateDiff(${1:endDate}, ${2:startDate}, \"${3|days,weeks,months,years,hours,minutes,seconds|}\")"
    ],
    "description": "Calculate difference between dates"
  },
  "Data Assignment": {
    "prefix": "data",
    "body": [
      "Data.${1:property} = ${2:value}"
    ],
    "description": "Assign to Data property"
  },
  "Data Access": {
    "prefix": "dataget",
    "body": [
      "Data.${1:property}"
    ],
    "description": "Access Data property"
  },
  "String ToUpper": {
    "prefix": "toupper",
    "body": [
      "ToUpper(${1:string})"
    ],
    "description": "Convert string to uppercase"
  },
  "String ToLower": {
    "prefix": "tolower",
    "body": [
      "ToLower(${1:string})"
    ],
    "description": "Convert string to lowercase"
  },
  "String Split": {
    "prefix": "split",
    "body": [
      "Split(${1:string}, \"${2:delimiter}\")"
    ],
    "description": "Split string into array"
  },
  "String Join": {
    "prefix": "join",
    "body": [
      "Join(${1:array}, \"${2:separator}\")"
    ],
    "description": "Join array into string"
  },
  "Array Append": {
    "prefix": "append",
    "body": [
      "Append(${1:array}, ${2:value})"
    ],
    "description": "Append value to array"
  },
  "Array Length": {
    "prefix": "length",
    "body": [
      "Length(${1:array})"
    ],
    "description": "Get array length"
  },
  "Now Timestamp": {
    "prefix": "now",
    "body": [
      "Now()"
    ],
    "description": "Get current UTC timestamp"
  },
  "Today Date": {
    "prefix": "today",
    "body": [
      "Today()"
    ],
    "description": "Get current UTC date at midnight"
  },
  "TypeOf Check": {
    "prefix": "typeof",
    "body": [
      "TypeOf(${1:value})"
    ],
    "description": "Get type of value"
  },
  "Return": {
    "prefix": "return",
    "body": [
      "return"
    ],
    "description": "Return from the script"
  },
  "Return with Value": {
    "prefix": "returnm",
    "body": [
      "return ${1:value}"
    ],
    "description": "Return from the script with a value"
  },
  "Fail": {
    "prefix": "fail",
    "body": [
      "fail"
    ],
    "description": "Fail script execution"
  },
  "Fail with Message": {
    "prefix": "failm",
    "body": [
      "fail \"${1:error message}\""
    ],
    "description": "Fail script execution with an error message"
  },
  "Any": {
    "prefix": "any",
    "body": [
      "Any(${1:array}, ${2:x} => ${3:condition})"
    ],
    "description": "Check if any element matches condition"
  },
  "All": {
    "prefix": "all",
    "body": [
      "All(${1:array}, ${2:x} => ${3:condition})"
    ],
    "description": "Check if all elements match condition"
  },
  "Find": {
    "prefix": "find",
    "body": [
      "Find(${1:array}, ${2:x} => ${3:condition})"
    ],
    "description": "Find first matching element"
  },
  "AnyByField": {
    "prefix": "anyfield",
    "body": [
      "AnyByField(${1:array}, \"${2:field}\", \"${3|==,!=,<,>,<=,>=|}\", ${4:value})"
    ],
    "description": "Check if any element matches field condition"
  },
  "AllByField": {
    "prefix": "allfield",
    "body": [
      "AllByField(${1:array}, \"${2:field}\", \"${3|==,!=,<,>,<=,>=|}\", ${4:value})"
    ],
    "description": "Check if all elements match field condition"
  },
  "FindByField": {
    "prefix": "findfield",
    "body": [
      "FindByField(${1:array}, \"${2:field}\", \"${3|==,!=,<,>,<=,>=|}\", ${4:value})"
    ],
    "description": "Find first element matching field condition"
  },
  "Merge Objects": {
    "prefix": "merge",
    "body": [
      "Merge([${1:object1}, ${2:object2}])"
    ],
    "description": "Merge objects (later overrides earlier)"
  },
  "Map": {
    "prefix": "map",
    "body": [
      "Map(${1:array}, ${2:x} => ${3:expression})"
    ],
    "description": "Transform each element in array"
  },
  "Where": {
    "prefix": "where",
    "body": [
      "Where(${1:array}, ${2:x} => ${3:condition})"
    ],
    "description": "Filter array by lambda condition"
  },
  "Reduce": {
    "prefix": "reduce",
    "body": [
      "Reduce(${1:array}, (${2:acc}, ${3:x}) => ${4:expression}, ${5:initialValue})"
    ],
    "description": "Reduce array to single value"
  },
  "Each": {
    "prefix": "each",
    "body": [
      "Each(${1:array}, ${2:x} => ${3:expression})"
    ],
    "description": "Execute expression for each element"
  },
  "SortBy": {
    "prefix": "sortby",
    "body": [
      "SortBy(${1:array}, ${2:x} => ${3:x.field})"
    ],
    "description": "Sort array by lambda expression"
  },
  "Is Null Check": {
    "prefix": "isnull",
    "body": [
      "${1:value} is null"
    ],
    "description": "Check if value is null"
  },
  "Is Not Null Check": {
    "prefix": "isnotnull",
    "body": [
      "${1:value} is not null"
    ],
    "description": "Check if value is not null"
  },
  "Null Coalescing": {
    "prefix": "??",
    "body": [
      "${1:value} ?? ${2:default}"
    ],
    "description": "Null coalescing operator"
  },
  "Select Fields": {
    "prefix": "select",
    "body": [
      "Select(${1:array}, \"${2:field}\")"
    ],
    "description": "Extract field from each object"
  },
  "Regex Match": {
    "prefix": "regexmatch",
    "body": [
      "RegexMatch(${1:text}, \"${2:pattern}\")"
    ],
    "description": "Extract first regex match as string"
  },
  "Regex Match All": {
    "prefix": "regexmatchall",
    "body": [
      "RegexMatchAll(${1:text}, \"${2:pattern}\")"
    ],
    "description": "Extract all regex matches as array"
  },
  "Regex Test": {
    "prefix": "regextest",
    "body": [
      "RegexTest(${1:text}, \"${2:pattern}\")"
    ],
    "description": "Test if pattern matches text"
  },
  "Regex Match Detail": {
    "prefix": "regexmatchdetail",
    "body": [
      "RegexMatchDetail(${1:text}, \"${2:pattern}\")"
    ],
    "description": "Extract first match with metadata (index, groups)"
  }
}
